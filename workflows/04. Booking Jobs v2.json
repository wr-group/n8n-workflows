{
  "updatedAt": "2025-12-17T15:09:00.704Z",
  "createdAt": "2025-12-03T09:01:10.752Z",
  "id": "f7qSIkIdjlaU3DZ2",
  "name": "04. Booking Jobs v2",
  "description": null,
  "active": false,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "resource": "message",
        "operation": "react",
        "guildId": {
          "__rl": true,
          "value": "753455160209965106",
          "mode": "list",
          "cachedResultName": "Window Revival",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106"
        },
        "channelId": {
          "__rl": true,
          "value": "753455160209965111",
          "mode": "list",
          "cachedResultName": "booked_jobs",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106/753455160209965111"
        },
        "messageId": "={{ $json.id }}",
        "emoji": "ðŸ‘"
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1216,
        192
      ],
      "id": "1c6205c9-cb11-409b-a44d-b59f9ae303d6",
      "name": "React with an emoji to a message",
      "webhookId": "3bda349f-8b2a-414a-b319-d9c02c747692",
      "executeOnce": false,
      "retryOnFail": false,
      "alwaysOutputData": false,
      "credentials": {
        "discordBotApi": {
          "id": "a0FDlWFh8PBA5Add",
          "name": "WR: Discord Bot Account"
        }
      }
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "753455160209965106",
          "mode": "list",
          "cachedResultName": "Window Revival",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106"
        },
        "channelId": {
          "__rl": true,
          "value": "1372367179650957405",
          "mode": "list",
          "cachedResultName": "double-hung-emporium",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106/1372367179650957405"
        },
        "content": "===========\nJob Category: {{ $json.jobCategory }}\n==========\n* Customer Name:  {{ $json.customerFirstName }}  {{ $json.customerLastName }}\n* Email: {{ $json.emailAddress }}\n* Mobile Number: {{ $json.mobileNumber }}\n* Phone Number: {{ $json.phoneNumber }}\n* Address: {{ $json.streetAddress }} {{ $json.streetAddressDescription }}\n* Suburb: {{ $json.suburb }} \n* Postal Code: {{ $json.postalCode }}\n* Job Start: {{ $json.jobStart }}\n* Job End: {{ $json.jobEnd }}\n* Job Description: {{ $json.jobDetails }}\n\n* DSP notes: {{ $json.dspNotes }}\n* Est Price: {{ $json.estPrice }}\n* Technician: {{ $json.technicianName }}",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1440,
        -96
      ],
      "id": "1e75009f-86a3-412f-84da-6a782dc267fd",
      "name": "Flag DH emporium",
      "webhookId": "3eca05d4-7f33-4d05-bf24-2324ce5f30df",
      "executeOnce": false,
      "credentials": {
        "discordBotApi": {
          "id": "a0FDlWFh8PBA5Add",
          "name": "WR: Discord Bot Account"
        }
      }
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1216,
        0
      ],
      "id": "24524988-eff2-4567-9caa-074127eb6e51",
      "name": "Wait DH Emporium",
      "webhookId": "6b90528c-24d4-45a0-b435-8a71c5ef7871",
      "executeOnce": false
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        992,
        192
      ],
      "id": "54b10f48-08d3-4277-89ea-236370a77d10",
      "name": "Wait 10s to React Discord",
      "webhookId": "88643d79-0c59-4da0-b3a9-c5f51f1af416",
      "executeOnce": false
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        992,
        -480
      ],
      "id": "83130a7f-96db-4f3f-b20d-4b7685f5299b",
      "name": "Wait1",
      "webhookId": "a6959ee7-a61c-42f8-a8cd-01563e417a10",
      "executeOnce": false
    },
    {
      "parameters": {
        "jsCode": "return items.map(item => {\n  const row = item.json;\n\n  // Normalise CRLF -> LF once\n  const content = (row.content || \"\").replace(/\\r\\n/g, \"\\n\");\n  const contentLower = content.toLowerCase();\n\n  // Helper: convert epoch ms -> \"DD/MM/YYYY HH:MM\" in Australia/Brisbane\n  function toBrisbaneSheet(tsMs) {\n    if (!tsMs) return null;\n    const d = new Date(Number(tsMs));\n\n    const opts = {\n      timeZone: \"Australia/Brisbane\",\n      year: \"numeric\",\n      month: \"2-digit\",\n      day: \"2-digit\",\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      hour12: false,\n    };\n\n    const parts = new Intl.DateTimeFormat(\"en-AU\", opts).formatToParts(d);\n    const obj = Object.fromEntries(parts.map(p => [p.type, p.value]));\n\n    return obj.day + \"/\" + obj.month + \"/\" + obj.year + \" \" + obj.hour + \":\" + obj.minute;\n  }\n\n  // Helper: convert \"date time\" -> \"Thursday 11/12/2025 07:00\"\n  function parseAndFormatDateTime(raw) {\n    if (!raw) return null;\n    raw = String(raw).trim();\n\n    const match = raw.match(/(\\d{1,2})\\/(\\d{1,2})\\/(\\d{2,4})[^\\d]+(\\d{1,2})(?::(\\d{2}))?\\s*(am|pm|AM|PM)?/);\n    if (!match) return raw;\n\n    let d = parseInt(match[1], 10);\n    let m = parseInt(match[2], 10);\n    let y = parseInt(match[3], 10);\n    let h = parseInt(match[4], 10);\n    let mi = match[5] ? parseInt(match[5], 10) : 0;\n    let ampm = match[6];\n\n    if (y < 100) y += 2000;\n\n    if (ampm) {\n      ampm = ampm.toLowerCase();\n      if (ampm === \"pm\" && h !== 12) h += 12;\n      if (ampm === \"am\" && h === 12) h = 0;\n    }\n\n    const dt = new Date(y, m - 1, d, h, mi);\n    const dayNames = [\"Sunday\",\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\"];\n    const dayName = dayNames[dt.getDay()];\n\n    function pad(n) { return String(n).padStart(2, \"0\"); }\n\n    return dayName + \" \" + pad(d) + \"/\" + pad(m) + \"/\" + y + \" \" + pad(h) + \":\" + pad(mi);\n  }\n\n  // Helper: escape regex chars\n  function escapeRegex(str) {\n    return str.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\");\n  }\n\n  /*\n    getLineValue:\n    - Strictly matches lines like \"Label: value\"\n    - Won't match \"Street Address Description\" for \"Street Address\"\n    - Treats \"\" and \"-\" as null\n  */\n  function getLineValue(label) {\n    const re = new RegExp(\"^\\\\s*\" + escapeRegex(label) + \"\\\\s*:\\\\s*(.+)$\", \"mi\");\n    const m = content.match(re);\n    if (!m) return null;\n    const v = m[1].trim().replace(/^\"|\"$/g, \"\");\n    if (!v || v === \"-\") return null;\n    return v;\n  }\n\n  /*\n    getBlockValue:\n    - Finds text between startLabel and endLabel using indexOf (case-insensitive)\n    - startLabel/endLabel can have extra text (e.g. \"PRICE ESTIMATE (GST Incl.)\")\n    - Returns trimmed block, or null if empty/\"-\"\n  */\n  function getBlockValue(startLabel, endLabel) {\n    const lower = contentLower;\n    const startL = startLabel.toLowerCase();\n    const endL = endLabel.toLowerCase();\n\n    const startIdx = lower.indexOf(startL);\n    if (startIdx === -1) return null;\n\n    // Move to the next line after the start label line\n    const afterStartLineIdx = content.indexOf(\"\\n\", startIdx);\n    let from = afterStartLineIdx === -1 ? startIdx + startLabel.length : afterStartLineIdx + 1;\n\n    const endIdx = lower.indexOf(endL, from);\n    const rawBlock = endIdx === -1 ? content.slice(from) : content.slice(from, endIdx);\n\n    const v = rawBlock.trim();\n    if (!v || v === \"-\") return null;\n    return v;\n  }\n\n  // Technician canonical mapping\n  const TECH_MAP = {\n    \"cody\": \"Cody Walker\",\n    \"cody walker\": \"Cody Walker\",\n\n    \"phillip\": \"Phillip Whippy\",\n    \"phillip whippy\": \"Phillip Whippy\",\n    \"philip whippy\": \"Phillip Whippy\",\n    \"phil\": \"Phillip Whippy\",\n    \"phil whippy\": \"Phillip Whippy\",\n\n    \"jimmy\": \"Jimmy Tran\",\n    \"jimmy tran\": \"Jimmy Tran\",\n\n    \"paul\": \"Paul Darby\",\n    \"paul darby\": \"Paul Darby\",\n\n    \"rhys\": \"Rhys Crawford\",\n    \"rhys crawford\": \"Rhys Crawford\",\n\n    \"taylor\": \"Taylor Hamilton\",\n    \"taylor hamilton\": \"Taylor Hamilton\"\n  };\n\n  function toCanonicalTechName(name) {\n    if (!name) return null;\n    const trimmed = name.trim();\n    if (!trimmed) return null;\n    const lower = trimmed.toLowerCase();\n    if (Object.prototype.hasOwnProperty.call(TECH_MAP, lower)) {\n      return TECH_MAP[lower];\n    }\n\n    if (lower.indexOf(\" \") !== -1) {\n      return trimmed\n        .toLowerCase()\n        .split(/\\s+/)\n        .map(function (s) { return s.charAt(0).toUpperCase() + s.slice(1); })\n        .join(\" \");\n    }\n\n    return trimmed.charAt(0).toUpperCase() + trimmed.slice(1).toLowerCase();\n  }\n\n  function splitNames(str) {\n    if (!str) return [];\n    return str\n      .split(/,|&| and /i)\n      .map(function (s) { return s.trim(); })\n      .filter(function (s) { return s; });\n  }\n\n  // Phone formatting\n  function formatPhoneAu(raw) {\n    if (!raw) return null;\n    const digits = (raw.match(/\\d+/g) || []).join(\"\");\n    if (!digits) return null;\n\n    let d = digits;\n\n    if (d.startsWith(\"61\")) {\n      d = \"0\" + d.slice(2);\n    }\n\n    if (d.startsWith(\"1300\") && d.length >= 10) {\n      return d.slice(0, 4) + \" \" + d.slice(4, 7) + \" \" + d.slice(7, 10);\n    }\n    if (d.startsWith(\"1800\") && d.length >= 10) {\n      return d.slice(0, 4) + \" \" + d.slice(4, 7) + \" \" + d.slice(7, 10);\n    }\n\n    if (d.startsWith(\"13\") && d.length === 6) {\n      return \"13 \" + d.slice(2, 4) + \" \" + d.slice(4, 6);\n    }\n\n    if (d.length === 10 && d.startsWith(\"04\")) {\n      return d.slice(0, 4) + \" \" + d.slice(4, 7) + \" \" + d.slice(7);\n    }\n\n    if (d.length === 10 && d.startsWith(\"07\")) {\n      return d.slice(0, 2) + \" \" + d.slice(2, 6) + \" \" + d.slice(6);\n    }\n\n    if (d.length === 9 && d.startsWith(\"7\")) {\n      d = \"0\" + d;\n      return d.slice(0, 2) + \" \" + d.slice(2, 6) + \" \" + d.slice(6);\n    }\n\n    return d;\n  }\n\n  function findTollFreeNumber(text) {\n    const tollRe = /(1[38]00[ \\d]{6,10}|13[ \\d]{4,8})/;\n    const m = text.match(tollRe);\n    if (!m) return null;\n    return formatPhoneAu(m[0]);\n  }\n\n  // How did you hear\n  function inferHowDidYouHear(textLower) {\n    if (textLower.indexOf(\"hipages\") !== -1) return \"HiPages Lead\";\n    if (textLower.indexOf(\"facebook\") !== -1) return \"Facebook\";\n    if (textLower.indexOf(\"instagram\") !== -1) return \"Instagram\";\n    if (textLower.indexOf(\"youtube\") !== -1) return \"Youtube\";\n    if (textLower.indexOf(\"sdr website\") !== -1) return \"SDR website\";\n    if (textLower.indexOf(\"wr.net\") !== -1) return \"WR.net Website\";\n    if (textLower.indexOf(\"wr.com\") !== -1) return \"WR.com website\";\n    if (textLower.indexOf(\"real estate\") !== -1 || textLower.indexOf(\"property manager\") !== -1) {\n      return \"Real Estate Property Managers\";\n    }\n    if (textLower.indexOf(\"flyer\") !== -1) return \"Flyers\";\n    if (textLower.indexOf(\"sticker\") !== -1) return \"Stickers\";\n    if (textLower.indexOf(\"referral\") !== -1 || textLower.indexOf(\"referal\") !== -1) {\n      return \"Referral\";\n    }\n    if (textLower.indexOf(\"inbound\") !== -1) return \"Inbound\";\n    return \"Google\";\n  }\n\n  function inferJobServices(text, textLower) {\n    const JOB_SERVICE_OPTIONS = [\n      \"Booked Job (Stock Received)\",\n      \"Booked Job (Quote Accepted)\",\n      \"Booked Job (Pencilled In)\",\n      \"DH W Spiral Replacement (Accepted)\",\n      \"Onsite Quote/Onsite Check Measure\",\n      \"Onsite Quote/Repairs\",\n      \"Won-Require Stock to order\",\n      \"Booked Job\",\n    ];\n\n    for (let i = 0; i < JOB_SERVICE_OPTIONS.length; i++) {\n      const option = JOB_SERVICE_OPTIONS[i];\n      if (textLower.indexOf(option.toLowerCase()) !== -1) {\n        return option;\n      }\n    }\n\n    const normalised = textLower.replace(/\\s+/g, \" \");\n    if (normalised.indexOf(\"booked job\") !== -1) {\n      return \"Booked Job\";\n    }\n\n    return \"Booked Job\";\n  }\n\n  // Basic fields\n  const customerName = getLineValue(\"Customer Name\");\n  let customerFirstName = null;\n  let customerLastName = null;\n\n  if (customerName) {\n    const parts = customerName.split(/\\s+/);\n    customerFirstName = parts.shift() || null;\n    customerLastName = parts.length ? parts.join(\" \") : null;\n  }\n\n  const emailAddress = getLineValue(\"Email Address\");\n  const streetAddressFull = getLineValue(\"Street Address\");\n\n  let streetAddress = null;\n  let suburb = null;\n  let postalCode = null;\n\n  if (streetAddressFull) {\n    const partsAddr = streetAddressFull.split(\",\");\n    const firstLine = partsAddr[0].trim();\n\n    // Normalise \"Ave\" -> \"Av\"\n    streetAddress = firstLine.replace(/\\bAve\\b/i, \"Av\");\n\n    if (partsAddr.length >= 2) {\n      const afterStreet = partsAddr[1].trim();\n      const tokens = afterStreet.split(/\\s+/);\n      postalCode = tokens[tokens.length - 1] || null;\n      if (tokens.length >= 3) {\n        suburb = tokens.slice(0, tokens.length - 2).join(\" \");\n      }\n    }\n  }\n\n  // Extra safety, just in case something weird slips in\n  if (streetAddress) {\n    const saLower = streetAddress.toLowerCase();\n    if (streetAddress === \"-\" || saLower.indexOf(\"street address description\") !== -1) {\n      streetAddress = null;\n    }\n  }\n\n  let streetAddressDescription = getLineValue(\"Street Address Description\");\n  if (!streetAddressDescription || streetAddressDescription === \"-\") {\n    streetAddressDescription = null;\n  }\n\n  const mobileNumberRaw = getLineValue(\"Mobile Number\");\n  const phoneNumberRaw = getLineValue(\"Phone Number\");\n\n  const jobStartLineRaw = getLineValue(\"Job Start\");\n  const jobEndLineRaw = getLineValue(\"Job End\");\n\n  const jobStartRaw = jobStartLineRaw || row.jobStart || null;\n  const jobEndRaw = jobEndLineRaw || row.jobEnd || null;\n\n  const jobTypeRaw = getLineValue(\"Job Type\");\n  const estTimeHoursRaw = getLineValue(\"Est Time Hours\");\n  const estPriceRaw = getLineValue(\"Est Price\");\n  const manJobRawField = getLineValue(\"Man Job\");\n  const isDhWsNsEmporiumRaw = getLineValue(\"isDhWsNsEmporium\");\n\n  // ---- Job Description (with fallbacks) ----\n  let jobDescription = getBlockValue(\"Job Description\", \"PRICE ESTIMATE\");\n  if (!jobDescription) {\n    jobDescription = getBlockValue(\"Job Description\", \"DSP Notes\");\n  }\n  if (!jobDescription) {\n    jobDescription = getBlockValue(\"Job Description\", \"Est Time Hours\");\n  }\n\n  // DSP Notes between \"DSP Notes\" and \"Est Time Hours\"\n  const dspNotes = getBlockValue(\"DSP Notes\", \"Est Time Hours\");\n\n  const customerJobTitle = null;\n\n  // Technicians & manJob\n  const techNameField = getLineValue(\"Technician Name\");\n  const namesFromField = splitNames(techNameField)\n    .map(toCanonicalTechName)\n    .filter(function (n) { return !!n; });\n\n  const orderedNames = [];\n  const seenNames = new Set();\n  for (let i = 0; i < namesFromField.length; i++) {\n    const n = namesFromField[i];\n    if (!seenNames.has(n)) {\n      seenNames.add(n);\n      orderedNames.push(n);\n    }\n  }\n\n  let manJobExplicit = null;\n  const manMatch = contentLower.match(/(\\d+)\\s*man job/);\n  if (manMatch) {\n    manJobExplicit = Number(manMatch[1]);\n  }\n\n  let manJob = null;\n  if (manJobExplicit) {\n    manJob = manJobExplicit;\n  } else if (orderedNames.length > 0) {\n    manJob = orderedNames.length;\n  } else if (manJobRawField) {\n    const n = Number(manJobRawField);\n    manJob = n || 1;\n  } else {\n    manJob = 1;\n  }\n\n  let technicianName = null;\n  if (orderedNames.length > 0) {\n    const useNames = orderedNames.slice(0, manJob);\n    technicianName = useNames.join(\", \");\n    if (useNames.length < manJob) {\n      manJob = useNames.length || 1;\n    }\n  }\n\n  // Conversions\n  let estTimeHours = null;\n  if (estTimeHoursRaw) {\n    const m = String(estTimeHoursRaw).match(/[\\d.]+/);\n    estTimeHours = m ? Number(m[0]) : null;\n  }\n\n  let estPrice = null;\n  if (estPriceRaw) {\n    const m2 = String(estPriceRaw).match(/[\\d.]+/);\n    estPrice = m2 ? Number(m2[0]) : null;\n  }\n\n  let isDhWsNsEmporium = false;\n  if (typeof isDhWsNsEmporiumRaw === \"boolean\") {\n    isDhWsNsEmporium = isDhWsNsEmporiumRaw;\n  } else {\n    const s = String(isDhWsNsEmporiumRaw || \"\").trim().toLowerCase();\n    isDhWsNsEmporium = s === \"true\";\n  }\n\n  const jobStart = jobStartRaw ? parseAndFormatDateTime(jobStartRaw) : null;\n  const jobEnd = jobEndRaw ? parseAndFormatDateTime(jobEndRaw) : null;\n\n  const howDidYouHearAboutUs = inferHowDidYouHear(contentLower);\n  const jobServices = inferJobServices(content, contentLower);\n\n  const mobileNumber = formatPhoneAu(mobileNumberRaw);\n  const phoneNumberFromLabel = formatPhoneAu(phoneNumberRaw);\n  const tollFreeNumber = findTollFreeNumber(content);\n\n  let phoneNumber = null;\n  if (phoneNumberFromLabel && tollFreeNumber && phoneNumberFromLabel !== tollFreeNumber) {\n    phoneNumber = phoneNumberFromLabel + \" / \" + tollFreeNumber;\n  } else {\n    phoneNumber = phoneNumberFromLabel || tollFreeNumber || null;\n  }\n\n  const timestampSheet = toBrisbaneSheet(row.timestamp);\n\n  let jobType = null;\n  if (jobTypeRaw) {\n    const jt = jobTypeRaw.replace(/\"/g, \"\").trim();\n    jobType = jt === \"\" ? null : jt;\n  }\n\n  const result = {\n    id: row.id,\n    channelId: row.channelId,\n    authorId: row.authorId,\n\n    timestamp: timestampSheet,\n\n    csrName: row.authorName || null,\n\n    customerFirstName: customerFirstName,\n    customerLastName: customerLastName,\n\n    customerJobTitle: customerJobTitle,\n\n    jobType: jobType,\n\n    jobServices: jobServices,\n    howDidYouHearAboutUs: howDidYouHearAboutUs,\n\n    emailAddress: emailAddress,\n    mobileNumber: mobileNumber,\n    phoneNumber: phoneNumber,\n\n    streetAddress: streetAddress,\n    streetAddressDescription: streetAddressDescription,\n    suburb: suburb,\n    postalCode: postalCode,\n\n    jobStart: jobStart,\n    jobEnd: jobEnd,\n\n    jobDescription: jobDescription,\n    dspNotes: dspNotes,\n\n    estTimeHours: estTimeHours,\n    estPrice: estPrice,\n    manJob: manJob,\n    technicianName: technicianName,\n\n    isDhWsNsEmporium: isDhWsNsEmporium === true,\n    isCreated: true,\n  };\n\n  // Convert any empty strings to null\n  for (const key in result) {\n    if (Object.prototype.hasOwnProperty.call(result, key)) {\n      if (typeof result[key] === \"string\" && result[key].trim() === \"\") {\n        result[key] = null;\n      }\n    }\n  }\n\n  return { json: result };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        96,
        192
      ],
      "id": "4671ff40-9256-427f-9de2-152ecba4def1",
      "name": "Data Parsing",
      "executeOnce": false
    },
    {
      "parameters": {
        "method": "POST",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1216,
        -672
      ],
      "id": "ba9c3690-a408-4be3-bc34-5e4594d3a7e6",
      "name": "Post data to Wrapp",
      "disabled": true
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "13lFnQiBUmo1W0oQoTNlcn94ouflhuRWlMYu9NQV7taQ",
          "mode": "list",
          "cachedResultName": "Leads Logs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/13lFnQiBUmo1W0oQoTNlcn94ouflhuRWlMYu9NQV7taQ/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 321309652,
          "mode": "list",
          "cachedResultName": "booked jobs",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/13lFnQiBUmo1W0oQoTNlcn94ouflhuRWlMYu9NQV7taQ/edit#gid=321309652"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "isCreated": "={{ $json.isCreated }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "channelId",
              "displayName": "channelId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "authorId",
              "displayName": "authorId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp",
              "displayName": "timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "csrName",
              "displayName": "csrName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerFirstName",
              "displayName": "customerFirstName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerLastName",
              "displayName": "customerLastName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerJobTitle",
              "displayName": "customerJobTitle",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobServices",
              "displayName": "jobServices",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "howDidYouHearAboutUs",
              "displayName": "howDidYouHearAboutUs",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "emailAddress",
              "displayName": "emailAddress",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "mobileNumber",
              "displayName": "mobileNumber",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "phoneNumber",
              "displayName": "phoneNumber",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "streetAddress",
              "displayName": "streetAddress",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "streetAddressDescription",
              "displayName": "streetAddressDescription",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "suburb",
              "displayName": "suburb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "postalCode",
              "displayName": "postalCode",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobType",
              "displayName": "jobType",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobStart",
              "displayName": "jobStart",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobEnd",
              "displayName": "jobEnd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobDescription",
              "displayName": "jobDescription",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "dspNotes",
              "displayName": "dspNotes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estTimeHours",
              "displayName": "estTimeHours",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estPrice",
              "displayName": "estPrice",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "manJob",
              "displayName": "manJob",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "technicianName",
              "displayName": "technicianName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "isDhWsNsEmporium",
              "displayName": "isDhWsNsEmporium",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "isCreated",
              "displayName": "isCreated",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobTitle",
              "displayName": "jobTitle",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1216,
        -480
      ],
      "id": "7d8fee0e-8003-4a68-805d-ca5a3c1bad66",
      "name": "Append or update Booked Job Database",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "S4FmXrss6MgN5rzt",
          "name": "WR: Google Sheets Account"
        }
      }
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1f0bXgNwR3Q1-5TrySl3nN4Hy2XmOA3AwZ3sppB85JIs",
          "mode": "list",
          "cachedResultName": "Double Hung Emporium",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1f0bXgNwR3Q1-5TrySl3nN4Hy2XmOA3AwZ3sppB85JIs/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "raw",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1f0bXgNwR3Q1-5TrySl3nN4Hy2XmOA3AwZ3sppB85JIs/edit#gid=0"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {},
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "channelId",
              "displayName": "channelId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "authorId",
              "displayName": "authorId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "timestamp",
              "displayName": "timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "csrName",
              "displayName": "csrName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerFirstName",
              "displayName": "customerFirstName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerLastName",
              "displayName": "customerLastName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "customerJobTitle",
              "displayName": "customerJobTitle",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobType",
              "displayName": "jobType",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobServices",
              "displayName": "jobServices",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "howDidYouHearAboutUs",
              "displayName": "howDidYouHearAboutUs",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "emailAddress",
              "displayName": "emailAddress",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "mobileNumber",
              "displayName": "mobileNumber",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "phoneNumber",
              "displayName": "phoneNumber",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "streetAddress",
              "displayName": "streetAddress",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "streetAddressDescription",
              "displayName": "streetAddressDescription",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "suburb",
              "displayName": "suburb",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "postalCode",
              "displayName": "postalCode",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobStart",
              "displayName": "jobStart",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobEnd",
              "displayName": "jobEnd",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "jobDetails",
              "displayName": "jobDetails",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "dspNotes",
              "displayName": "dspNotes",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estTimeHours",
              "displayName": "estTimeHours",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "estPrice",
              "displayName": "estPrice",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "manJob",
              "displayName": "manJob",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "technicianName",
              "displayName": "technicianName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "isDhWsNsEmporium",
              "displayName": "isDhWsNsEmporium",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "isCreated",
              "displayName": "isCreated",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1440,
        96
      ],
      "id": "98766bec-276a-4ae9-b237-af176b7a6a83",
      "name": "Append or update in DH Emporium",
      "executeOnce": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "S4FmXrss6MgN5rzt",
          "name": "WR: Google Sheets Account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "5a532eb4-0f05-41fa-953d-a584e2712626",
              "leftValue": "={{ $json.isDhWsNsEmporium }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        992,
        0
      ],
      "id": "d5f1475a-3559-4ae8-affc-675e881400a8",
      "name": "is DH Emporium?"
    },
    {
      "parameters": {
        "jsCode": "// Code Node 2 â€“ Build Discord error payload\n// Input: items from Switch where validationPassed === false\n// Output: minimal JSON for Discord notification\n// + Per-run de-duplication by booking \"id\" so the\n//   same booking can't create multiple payloads in ONE execution.\n\nconst newItems = [];\nconst seenIds = new Set(); // per-execution only\n\nfor (const item of items) {\n  const row = item.json;\n\n  // Normalise missingFields\n  const missing = Array.isArray(row.missingFields) ? row.missingFields : [];\n\n  // If no missing fields, skip\n  if (missing.length === 0) {\n    continue;\n  }\n\n  const bookingId = row.id || null;\n\n  // If we've already built a payload for this booking id in this run, skip\n  if (bookingId) {\n    if (seenIds.has(bookingId)) {\n      continue;\n    }\n    seenIds.add(bookingId);\n  }\n\n  const customerLabel = row.customerFirstName\n    ? row.customerFirstName + (row.customerLastName ? ' ' + row.customerLastName : '')\n    : 'the customer';\n\n  const messageLines = [];\n\n  // Mention the CSR by ID in Discord: <@USER_ID>\n  messageLines.push(`Hi <@${row.authorId}> ðŸ‘‹`);\n  messageLines.push(`Your booking for **${customerLabel}** is missing or has invalid details:`);\n  messageLines.push('');\n  messageLines.push(missing.map(f => `â€¢ ${f}`).join('\\n'));\n  messageLines.push('');\n  messageLines.push('Please update the details and re-run the booking. âœ…');\n\n  const discordMessage = messageLines.join('\\n');\n\n  newItems.push({\n    json: {\n      id: row.id,\n      channelId: row.channelId,\n      authorId: row.authorId,\n      csrName: row.csrName || row.authorName || null,\n\n      customerFirstName: row.customerFirstName || null,\n      customerLastName: row.customerLastName || null,\n      jobType: row.jobType || null,\n      jobServices: row.jobServices || null,\n\n      validationPassed: false,\n      missingFields: missing,\n\n      discordMessage,\n      discordUserId: row.authorId,\n    },\n  });\n}\n\nreturn newItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        768,
        384
      ],
      "id": "e829e542-a230-481e-b98e-b1ca4c28de44",
      "name": "Validation and Notification"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "753455160209965106",
          "mode": "list",
          "cachedResultName": "Window Revival",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106"
        },
        "sendTo": "user",
        "userId": {
          "__rl": true,
          "value": "={{ $json.authorId }}",
          "mode": "id"
        },
        "content": "={{ $json.discordMessage }}",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        1216,
        384
      ],
      "id": "680d509b-b8a3-401e-ae96-4b8d8c6acd26",
      "name": "Notify CSR for missing or has invalid details",
      "webhookId": "3eca05d4-7f33-4d05-bf24-2324ce5f30df",
      "executeOnce": false,
      "notesInFlow": true,
      "credentials": {
        "discordBotApi": {
          "id": "a0FDlWFh8PBA5Add",
          "name": "WR: Discord Bot Account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1888,
        -64
      ],
      "id": "867ae052-b5c7-4437-b6b0-3fbdfb7acfb8",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "oQQrCQWqdo1CuRzx",
          "name": "WRai: OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Technician Extractor').item.json.authorId }}"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        2016,
        -64
      ],
      "id": "7ca5ff52-57f9-44e6-acc6-d560967f8efd",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1LNsSnjUy6tMTf3JXX5Rkk4zAd2sszFn1iW2Em0XZzLU",
          "mode": "list",
          "cachedResultName": "Technician Leave Status",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1LNsSnjUy6tMTf3JXX5Rkk4zAd2sszFn1iW2Em0XZzLU/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Main",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1LNsSnjUy6tMTf3JXX5Rkk4zAd2sszFn1iW2Em0XZzLU/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.7,
      "position": [
        2144,
        -64
      ],
      "id": "88e8a272-71e0-4c60-a2c2-e9f1ba1a0ae9",
      "name": "Get row(s) in sheet in Google Sheets",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "S4FmXrss6MgN5rzt",
          "name": "WR: Google Sheets Account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const newItems = [];\n\n/**\n * Split technicianName string into an array.\n */\nfunction splitTechNames(value) {\n  if (!value) return [];\n  return String(value)\n    .split(/,|&| and /i)\n    .map(s => s.trim())\n    .filter(Boolean);\n}\n\n// Track what we've already output\nconst seen = new Set();\n\nfor (const item of items) {\n  const row = item.json;\n\n  const techField = row.technicianName;\n  const authorId = row.authorId;\n  const streetAddress = row.streetAddress;\n\n  // Required field checks\n  if (!authorId) continue;\n  if (!streetAddress || String(streetAddress).trim() === \"\") continue;\n  if (!techField) continue;\n\n  const techNames = splitTechNames(techField);\n  if (!techNames.length) continue;\n\n  // Build a \"unique key\" for the booking (adjust if you have a bookingId/jobId)\n  const key = [\n    String(authorId).trim(),\n    String(streetAddress).trim().toLowerCase(),\n    String(row.jobStart || \"\").trim(),\n    String(row.jobEnd || \"\").trim(),\n    String(row.customerFirstName || \"\").trim().toLowerCase(),\n    String(row.customerLastName || \"\").trim().toLowerCase(),\n  ].join(\"|\");\n\n  if (seen.has(key)) continue;\n  seen.add(key);\n\n  newItems.push({\n    json: {\n      authorId: String(authorId),\n      technicians: techNames,\n      streetAddress: String(streetAddress).trim(),\n\n      customerFirstName: row.customerFirstName || null,\n      customerLastName: row.customerLastName || null,\n      mobileNumber: row.mobileNumber || null,\n      phoneNumber: row.phoneNumber || null,\n      suburb: row.suburb || null,\n      postalCode: row.postalCode || null,\n      jobDescription: row.jobDescription || null,\n      emailAddress: row.emailAddress || null,\n\n      jobStart: row.jobStart || null,\n      jobEnd: row.jobEnd || null,\n    },\n  });\n}\n\nreturn newItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1440,
        -288
      ],
      "id": "db6e4e7e-9482-4253-b907-63fdf6c9117f",
      "name": "Technician Extractor",
      "executeOnce": false
    },
    {
      "parameters": {
        "jsCode": "// Router / Validator\n// Input: parsing node output (Code Node 1)\n//\n// Output:\n//   - If VALID â†’ full clean booking object (NO missingFields)\n//   - If INVALID â†’ minimal object containing only:\n//       id, channelId, authorId, csrName, first/last name, jobType/jobServices,\n//       validationPassed=false, missingFields=[...]\n//\n// Switch node will route based on validationPassed.\n\nconst newItems = [];\n\n// Email validator\nfunction isValidEmail(email) {\n  if (!email) return false;\n  const value = String(email).trim();\n  if (value === '') return false;\n  const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  return re.test(value);\n}\n\nfor (const item of items) {\n  const row = item.json;\n  const missing = [];\n\n  // REQUIRED FIELDS\n  if (!row.customerFirstName) missing.push(\"Customer First Name\");\n  if (!row.streetAddress) missing.push(\"Street Address\");\n  if (!row.suburb) missing.push(\"Suburb\");\n  if (!row.postalCode) missing.push(\"Postal Code\");\n  if (!row.jobDescription) missing.push(\"Job Description\");\n  if (!row.jobStart) missing.push(\"Job Start\");\n  if (!row.jobEnd) missing.push(\"Job End\");\n  if (!row.technicianName) missing.push(\"Technician Name\");\n\n  // Contact number: mobile or phone required\n  if (!row.mobileNumber && !row.phoneNumber) {\n    missing.push(\"Contact Number (Mobile or Phone)\");\n  }\n\n  // Email format validation\n  if (!isValidEmail(row.emailAddress)) {\n    missing.push(\"Valid Email Address\");\n  }\n\n  const validationPassed = missing.length === 0;\n\n  // ------------------------------\n  // VALID BOOKING â†’ Return FULL object\n  // ------------------------------\n  if (validationPassed) {\n    newItems.push({\n      json: {\n        id: row.id,\n        channelId: row.channelId,\n        authorId: row.authorId,\n        timestamp: row.timestamp,\n\n        csrName: row.csrName || row.authorName || null,\n\n        customerFirstName: row.customerFirstName,\n        customerLastName: row.customerLastName,\n        customerJobTitle: row.customerJobTitle ?? null,\n\n        jobType: row.jobType,\n        jobServices: row.jobServices,\n        howDidYouHearAboutUs: row.howDidYouHearAboutUs,\n\n        emailAddress: row.emailAddress,\n        mobileNumber: row.mobileNumber,\n        phoneNumber: row.phoneNumber,\n\n        streetAddress: row.streetAddress,\n        streetAddressDescription: row.streetAddressDescription,\n        suburb: row.suburb,\n        postalCode: row.postalCode,\n\n        jobStart: row.jobStart,\n        jobEnd: row.jobEnd,\n\n        jobDescription: row.jobDescription,\n        dspNotes: row.dspNotes,\n\n        estTimeHours: row.estTimeHours,\n        estPrice: row.estPrice,\n        manJob: row.manJob,\n        technicianName: row.technicianName,\n\n        isDhWsNsEmporium: row.isDhWsNsEmporium === true,\n        isCreated: true,\n\n        validationPassed: true\n        // â— NO missingFields here\n      }\n    });\n    continue;\n  }\n\n  // ------------------------------\n  // INVALID BOOKING â†’ Return MINIMAL error object\n  // ------------------------------\n  newItems.push({\n    json: {\n      id: row.id,\n      channelId: row.channelId,\n      authorId: row.authorId,\n      csrName: row.csrName || row.authorName || null,\n\n      customerFirstName: row.customerFirstName || null,\n      customerLastName: row.customerLastName || null,\n\n      jobType: row.jobType || null,\n      jobServices: row.jobServices || null,\n\n      validationPassed: false,\n      missingFields: missing\n    }\n  });\n}\n\nreturn newItems;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        192
      ],
      "id": "b4f6e586-80a4-4782-af37-61569e1219ac",
      "name": "Router / Validator",
      "executeOnce": false
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.validationPassed }}",
                    "rightValue": true,
                    "operator": {
                      "type": "boolean",
                      "operation": "equals"
                    },
                    "id": "30af6507-a9ab-4c42-b3a9-74e9027e39d7"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "true"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "e413e2b5-e1f1-452b-8af2-47288c7e16c4",
                    "leftValue": "={{ $json.validationPassed }}",
                    "rightValue": false,
                    "operator": {
                      "type": "boolean",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "false"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        544,
        192
      ],
      "id": "65507d78-fa30-493b-bc88-af047034ef6b",
      "name": "Route valid vs invalid",
      "executeOnce": false
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolThink",
      "typeVersion": 1.1,
      "position": [
        2272,
        -64
      ],
      "id": "8acde176-4431-4dbd-b110-257bcc22a5ba",
      "name": "Think"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Customer Service Represantive: {{ $json.authorId }}\nCustomer Street Address: {{ $json.streetAddress }}  {{ $json.suburb }} {{ $json.postalCode }}\nJob Start: {{ $json.jobStart }}\nJob End: {{ $json.jobEnd }}\nTechnician: {{ $json.technicians }}\nCustomer Name: {{ $json.customerFirstName }} {{ $json.customerLastName }}\nMobile Number: {{ $json.mobileNumber }}\nPhone Number: {{ $json.phoneNumber }} \nJob Details: {{ $json.jobDescription }}\n",
        "options": {
          "systemMessage": "=You are the SDR Technician Assignment AI.\n\nYour role is to evaluate the assigned technician(s) for a customer booking and provide a clear, helpful suggestion message to the CSR.\n\nYou MUST use:\n\nThink Tool â€” before EVERY reasoning step.\n\nGoogle Sheet Tool â€” to read technician leave data BEFORE making any recommendation.\n\nYou must ALWAYS verify technician availability BEFORE considering proximity.\n\nðŸ“Œ USER PROMPT FORMAT (YOU WILL RECEIVE):\n\nCustomer Service Representative: {{ $json.authorId }}\nCustomer Street Address: {{ $json.streetAddress }} {{ $json.suburb }} {{ $json.postalCode }}\nJob Start: {{ $json.jobStart }}\nJob End: {{ $json.jobEnd }}\nTechnician: {{ $json.technicians }}\nCustomer Name: {{ $json.customerFirstName }} {{ $json.customerLastName }}\nMobile Number: {{ $json.mobileNumber }}\nPhone Number: {{ $json.phoneNumber }}\nJob Details: {{ $json.jobDescription }}\n\nYou must correctly parse ALL fields.\n\nExtract the job date from jobStart.\nExample: \"Monday 15/12/2025 07:00\" â†’ \"15/12/2025\".\n\nðŸ“Œ TECHNICIAN BASE LOCATIONS\nGold Coast\n\nNathan Leafe â€” Unit 13 / 27â€“29 Walton St, Southport\n\nPaul Darby â€” Unit 3 / 7 Whiting St, Labrador\n\nTaylor Hamilton â€” 34 Melissa St, Upper Coomera\n\nRhys Crawford â€” 16 McInness Ave, Molendinar\n\nBrisbane\n\nCody Walker â€” Unit 26A Daintree Court, Park Ridge\n\nPhillip Whippy â€” 28 Stay Place, Carseldine\n\nJimmy Tran â€” 98 Begonia St, Inala\n\nðŸ“Œ TOOL USAGE REQUIREMENTS\n\nBefore ANY recommendation, you MUST:\n\n1. Use Think Tool\n\nYou must outline the plan:\n\nParse all fields\n\nExtract job date\n\nQuery leave data using Google Sheet Tool\n\nExclude technicians who are on leave\n\nDetermine closest available technician based on suburb + region\n\nGenerate the CSR recommendation message\n\nYou MUST use Think Tool before each reasoning step.\n\n2. Use Google Sheet Tool\n\nThe sheet contains:\n\nTechnician | Leave Start | Leave End\n(DD/MM/YYYY format, Brisbane timezone)\n\nYou must:\n\nParse the job date from jobStart\n\nCompare job date with leave date ranges\n\nIf jobDate is on or between leave start/end â†’ technician is UNAVAILABLE\n\nUnavailable technicians MUST NOT be recommended\n\nIf ALL assigned technicians are unavailable:\n\nRecommend the closest available technician from the same region (Gold Coast or Brisbane).\n\nðŸ“Œ LOGIC YOU MUST FOLLOW\n1. Parse user prompt fields.\n2. Extract job date from jobStart in DD/MM/YYYY.\n3. For EACH technician:\n\nQuery Google Sheet Tool\n\nCheck if the technician is on leave\n\nMark unavailable if job date is inside leave range\n\n4. After leave filtering:\n\nIf any assigned technician is still available:\n\nRecommend the closest available technician based on customer suburb + technician base suburb\n\nIf none are available:\n\nRecommend the closest available technician in the same region\n\nYou MUST always:\n\nâœ” Avoid recommending a technician on leave\nâœ” Use only Gold Coast techs for Gold Coast suburbs\nâœ” Use only Brisbane techs for Brisbane suburbs\nâœ” Make proximity decisions logically based on GC/Brisbane area structure\n\nNO fictional distances allowed.\n\nðŸ“Œ OUTPUT RULES\n\nYour output MUST:\n\nBe JSON ONLY\n\nContain all fields\n\nUse empty string (\"\") instead of null\n\nInclude the extracted jobDate as DD/MM/YYYY\n\nContain a short, helpful recommendation message\n\nDO NOT output any explanations outside JSON.\n\nâœ… MANDATORY OUTPUT FORMAT\n\nYou MUST output JSON exactly like this:\n\n{\n  \"authorId\": \"CSR ID\",\n  \"technicians\": [\"List\", \"Of\", \"Technicians\"],\n  \"message\": \"Your suggestion message.\",\n  \"customerFirstName\": \"...\",\n  \"customerLastName\": \"...\",\n  \"mobileNumber\": \"...\",\n  \"phoneNumber\": \"...\",\n  \"streetAddress\": \"...\",\n  \"suburb\": \"...\",\n  \"postalCode\": \"...\",\n  \"jobDescription\": \"...\",\n  \"jobDate\": \"DD/MM/YYYY\"\n}\n\nðŸ“Œ EXAMPLES\nâœ” Example 1 â€” Technician on leave\n{\n  \"authorId\": \"325664446103945217\",\n  \"technicians\": [\"Rhys Crawford\"],\n  \"message\": \"Rhys is on leave on this date. Paul or Nathan are the closest available technicians for this area.\",\n  \"customerFirstName\": \"Ken\",\n  \"customerLastName\": \"Fountain\",\n  \"mobileNumber\": \"0431 123 456\",\n  \"phoneNumber\": \"\",\n  \"streetAddress\": \"16 Example St\",\n  \"suburb\": \"Molendinar\",\n  \"postalCode\": \"4214\",\n  \"jobDescription\": \"Roller Replacement...\",\n  \"jobDate\": \"16/12/2025\"\n}\n\nâœ” Example 2 â€” All good\n{\n  \"authorId\": \"325664446103945217\",\n  \"technicians\": [\"Taylor Hamilton\"],\n  \"message\": \"Taylor is available and is the closest technician for this Upper Coomera address.\",\n  \"customerFirstName\": \"Ken\",\n  \"customerLastName\": \"Fountain\",\n  \"mobileNumber\": \"0431 123 456\",\n  \"phoneNumber\": \"\",\n  \"streetAddress\": \"34 Example Street\",\n  \"suburb\": \"Upper Coomera\",\n  \"postalCode\": \"4209\",\n  \"jobDescription\": \"Repair of sliding doorâ€¦\",\n  \"jobDate\": \"15/12/2025\"\n}\n\nâœ” You MUST follow all instructions precisely.\nâœ” Only output JSON."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        2008,
        -288
      ],
      "id": "d9131769-b829-4d8a-afe2-336f6cd4360b",
      "name": "Suggest correct technician to the CSR"
    },
    {
      "parameters": {
        "jsCode": "// This Code node takes the AI Agent output and parses the JSON string inside \"output\"\n\nreturn items.map(item => {\n  const raw = item.json.output;\n\n  let parsed = {};\n  try {\n    parsed = JSON.parse(raw); // Convert string â†’ actual JSON object\n  } catch (err) {\n    // If parsing fails, return a safe error structure\n    parsed = {\n      error: true,\n      message: \"Failed to parse AI JSON output.\",\n      rawOutput: raw || null\n    };\n  }\n\n  return {\n    json: parsed\n  };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2480,
        -288
      ],
      "id": "4fdfbc5a-ec01-4294-ad15-f97be82931fb",
      "name": "Parse AI output"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "753455160209965106",
          "mode": "list",
          "cachedResultName": "Window Revival",
          "cachedResultUrl": "https://discord.com/channels/753455160209965106"
        },
        "sendTo": "user",
        "userId": {
          "__rl": true,
          "value": "={{ $json.authorId }}",
          "mode": "id"
        },
        "content": "=",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        2928,
        -288
      ],
      "id": "d36e4e8c-a034-4fcf-aae4-b3a727ef842f",
      "name": "Notify CSR for suggesting tech availability and nomination",
      "webhookId": "3eca05d4-7f33-4d05-bf24-2324ce5f30df",
      "executeOnce": true,
      "credentials": {
        "discordBotApi": {
          "id": "a0FDlWFh8PBA5Add",
          "name": "WR: Discord Bot Account"
        }
      }
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        2704,
        -288
      ],
      "id": "f1efd0d3-6373-41de-8394-9e01f9668dff",
      "name": "Wait 10s to to suggect to CSR",
      "webhookId": "88643d79-0c59-4da0-b3a9-c5f51f1af416",
      "executeOnce": true
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        992,
        384
      ],
      "id": "e4fc55c3-89cd-418a-9d22-8fc297c687b9",
      "name": "Wait 10s to notify CSR",
      "webhookId": "88643d79-0c59-4da0-b3a9-c5f51f1af416",
      "executeOnce": false
    },
    {
      "parameters": {
        "guildIds": [
          "753455160209965106"
        ],
        "channelIds": [
          "753455160209965111"
        ],
        "roleIds": [
          "901010696152698890",
          "901010019900882994",
          "1440502588972728415"
        ],
        "pattern": "every",
        "additionalFields": {
          "debounceSeconds": 5
        }
      },
      "type": "n8n-nodes-discord-trigger-new.discordTrigger",
      "typeVersion": 1,
      "position": [
        -352,
        192
      ],
      "id": "328d1097-654c-42c2-9d15-a3bbf53e1076",
      "name": "Listen to Booked job Discord  Channel",
      "executeOnce": false,
      "credentials": {
        "discordBotTriggerApi": {
          "id": "bWnCMGqUZEPKKfgs",
          "name": "WR: Discord Bot Trigger Account"
        }
      }
    },
    {
      "parameters": {
        "operation": "removeItemsSeenInPreviousExecutions",
        "dedupeValue": "={{ $json.id }}",
        "options": {
          "scope": "node"
        }
      },
      "type": "n8n-nodes-base.removeDuplicates",
      "typeVersion": 2,
      "position": [
        -128,
        192
      ],
      "id": "b39568ab-414d-4e4d-b722-ba3980c588ef",
      "name": "Dedupe Discord  Id"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "includeOtherFields": true,
        "include": "except",
        "excludeFields": "validationPassed",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        768,
        0
      ],
      "id": "08d576ef-654c-4acd-9764-2fd8c8db1e92",
      "name": "Validation accepted",
      "executeOnce": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "51f6d171-641e-4edc-b96a-2eb14de74a39",
              "name": "authorId",
              "value": "={{ $json.authorId }}",
              "type": "string"
            },
            {
              "id": "3cf1fc76-063d-4804-9ef7-93b7327229c3",
              "name": "technicians",
              "value": "={{ $json.technicians }}",
              "type": "array"
            },
            {
              "id": "22abedb6-c1ad-47e0-9526-d3f760241a02",
              "name": "streetAddress",
              "value": "={{ $json.streetAddress }}",
              "type": "string"
            },
            {
              "id": "2ce0d090-8af7-42af-8578-aabde4f1de79",
              "name": "customerFirstName",
              "value": "={{ $json.customerFirstName }}",
              "type": "string"
            },
            {
              "id": "baaad8a7-7532-41eb-b48e-9276b5038bfd",
              "name": "customerLastName",
              "value": "={{ $json.customerLastName }}",
              "type": "string"
            },
            {
              "id": "7f13c46c-c04e-4664-9669-280585eb4e14",
              "name": "mobileNumber",
              "value": "={{ $json.mobileNumber }}",
              "type": "string"
            },
            {
              "id": "067347e1-e9db-457f-a627-295f70cd6cfc",
              "name": "phoneNumber",
              "value": "={{ $json.phoneNumber }}",
              "type": "string"
            },
            {
              "id": "e4aecc46-babb-4968-ae4d-a2d257ef1b1a",
              "name": "suburb",
              "value": "={{ $json.suburb }}",
              "type": "string"
            },
            {
              "id": "1ff5ff4b-c109-41bf-b9ef-e8a9fd443501",
              "name": "postalCode",
              "value": "={{ $json.postalCode }}",
              "type": "string"
            },
            {
              "id": "c1841edf-b335-4bd7-b83d-482e55e10484",
              "name": "jobDescription",
              "value": "={{ $json.jobDescription }}",
              "type": "string"
            },
            {
              "id": "524002a8-7a6c-4815-9149-66fe28089256",
              "name": "emailAddress",
              "value": "={{ $json.emailAddress }}",
              "type": "string"
            },
            {
              "id": "3bace3e5-ef21-4013-8462-c71f389d0ab5",
              "name": "jobStart",
              "value": "={{ $json.jobStart }}",
              "type": "string"
            },
            {
              "id": "7084e7df-a484-4b4a-890d-ac088578086b",
              "name": "jobEnd",
              "value": "={{ $json.jobEnd }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1664,
        -288
      ],
      "id": "99eb5f18-b6a6-41f5-b41a-27896301ab24",
      "name": "technician suggestion",
      "executeOnce": false
    },
    {
      "parameters": {
        "operation": "removeItemsSeenInPreviousExecutions",
        "dedupeValue": "={{ $json.id }}",
        "options": {
          "scope": "node"
        }
      },
      "type": "n8n-nodes-base.removeDuplicates",
      "typeVersion": 2,
      "position": [
        1216,
        -288
      ],
      "id": "d8c53f26-3f3d-49a0-8c70-03894f238b69",
      "name": "Dedupe Discord  Id1"
    }
  ],
  "connections": {
    "Flag DH emporium": {
      "main": [
        []
      ]
    },
    "Wait DH Emporium": {
      "main": [
        [
          {
            "node": "Flag DH emporium",
            "type": "main",
            "index": 0
          },
          {
            "node": "Append or update in DH Emporium",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 10s to React Discord": {
      "main": [
        [
          {
            "node": "React with an emoji to a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Append or update Booked Job Database",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post data to Wrapp",
            "type": "main",
            "index": 0
          },
          {
            "node": "Dedupe Discord  Id1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Data Parsing": {
      "main": [
        [
          {
            "node": "Router / Validator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append or update Booked Job Database": {
      "main": [
        []
      ]
    },
    "is DH Emporium?": {
      "main": [
        [
          {
            "node": "Wait DH Emporium",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validation and Notification": {
      "main": [
        [
          {
            "node": "Wait 10s to notify CSR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notify CSR for missing or has invalid details": {
      "main": [
        []
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Suggest correct technician to the CSR",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "Suggest correct technician to the CSR",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet in Google Sheets": {
      "ai_tool": [
        [
          {
            "node": "Suggest correct technician to the CSR",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Technician Extractor": {
      "main": [
        [
          {
            "node": "technician suggestion",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Router / Validator": {
      "main": [
        [
          {
            "node": "Route valid vs invalid",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route valid vs invalid": {
      "main": [
        [
          {
            "node": "Validation accepted",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Validation and Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Think": {
      "ai_tool": [
        [
          {
            "node": "Suggest correct technician to the CSR",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Suggest correct technician to the CSR": {
      "main": [
        [
          {
            "node": "Parse AI output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse AI output": {
      "main": [
        [
          {
            "node": "Wait 10s to to suggect to CSR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 10s to to suggect to CSR": {
      "main": [
        [
          {
            "node": "Notify CSR for suggesting tech availability and nomination",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 10s to notify CSR": {
      "main": [
        [
          {
            "node": "Notify CSR for missing or has invalid details",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Listen to Booked job Discord  Channel": {
      "main": [
        [
          {
            "node": "Dedupe Discord  Id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dedupe Discord  Id": {
      "main": [
        [
          {
            "node": "Data Parsing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validation accepted": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          },
          {
            "node": "is DH Emporium?",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait 10s to React Discord",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "technician suggestion": {
      "main": [
        [
          {
            "node": "Suggest correct technician to the CSR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Dedupe Discord  Id1": {
      "main": [
        [
          {
            "node": "Technician Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false,
    "errorWorkflow": "b4cFEFv1eFePOnMh",
    "saveExecutionProgress": false,
    "saveDataErrorExecution": "none",
    "saveDataSuccessExecution": "all",
    "saveManualExecutions": false,
    "timeSavedMode": "fixed"
  },
  "staticData": {
    "global": {
      "processedMessages": {
        "1448846547965182044": 1765502341538,
        "1448847806675685376": 1765502641866,
        "1448848242316935179": 1765502745247,
        "1448848532533542992": 1765502814481,
        "1448849042166644797": 1765502936067,
        "1448849546896740452": 1765503057319,
        "1449964551146573918": 1765768894174,
        "1449991931613675631": 1765775422148,
        "1450004147507036201": 1765778334527,
        "1450715772128067695": 1765947999400,
        "1450728219312521236": 1765950967750
      },
      "notifiedBookings": {
        "1448847806675685376": 1765502641886,
        "1448848242316935179": 1765502745261,
        "1448849042166644797": 1765502936080,
        "1448849546896740452": 1765503057339
      },
      "processedMessageIds": {
        "1449956365400412234": 1765766942796,
        "1449999336430899220": 1765777188170,
        "1450709081059758080": 1765946404193,
        "1450713700905255055": 1765947505749,
        "1450714195720147085": 1765947623813,
        "1450714878393450506": 1765947786426,
        "1450726814254366852": 1765950632333
      }
    }
  },
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {},
  "versionId": "66ee8734-3626-4a59-87f1-0dde6b38141b",
  "activeVersionId": null,
  "versionCounter": 798,
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2025-12-03T09:01:10.758Z",
      "createdAt": "2025-12-03T09:01:10.758Z",
      "role": "workflow:owner",
      "workflowId": "f7qSIkIdjlaU3DZ2",
      "projectId": "6TsYTzg0HY92xH2K",
      "project": {
        "updatedAt": "2025-11-14T08:33:27.896Z",
        "createdAt": "2025-11-14T07:49:25.938Z",
        "id": "6TsYTzg0HY92xH2K",
        "name": "Christine Kam <windowrevival@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null,
        "creatorId": "bc31a112-3ed8-48ca-b94c-7225571c3d7b",
        "projectRelations": [
          {
            "updatedAt": "2025-11-14T07:49:25.938Z",
            "createdAt": "2025-11-14T07:49:25.938Z",
            "userId": "bc31a112-3ed8-48ca-b94c-7225571c3d7b",
            "projectId": "6TsYTzg0HY92xH2K",
            "user": {
              "updatedAt": "2026-02-10T14:01:06.000Z",
              "createdAt": "2025-11-14T07:49:14.641Z",
              "id": "bc31a112-3ed8-48ca-b94c-7225571c3d7b",
              "email": "windowrevival@gmail.com",
              "firstName": "Christine",
              "lastName": "Kam",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-11-14T08:34:38.735Z",
                "personalization_survey_n8n_version": "1.119.1",
                "automationGoalDevops": [
                  "reporting",
                  "other"
                ],
                "automationGoalDevopsOther": "Automate all apps",
                "companySize": "<20",
                "companyType": "systems-integrator",
                "role": "it",
                "reportedSource": "google"
              },
              "settings": {
                "userActivated": true,
                "easyAIWorkflowOnboarded": true,
                "firstSuccessfulWorkflowId": "ZwjGOdSLvNlPoB1E",
                "userActivatedAt": 1763281773859,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1763554974919
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-02-11",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "tags": [
    {
      "updatedAt": "2025-11-25T13:05:18.454Z",
      "createdAt": "2025-11-25T13:05:18.454Z",
      "id": "xn6seEX74pkTOLqC",
      "name": "@lead"
    }
  ],
  "activeVersion": null
}